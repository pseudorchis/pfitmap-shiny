<!DOCTYPE html>
<html>
  <meta charset='utf-8'/>
  <head>
    <title>Test table</title>
    <script src="http://d3js.org/d3.v4.min.js"></script>
  </head>
  <body>
    <h1>Erik och Daniel testar D3</h1>
    <div class='proteintable'></div>
    <p>Den här texten kommer efter tabell-diven men före skriptet.</p>
    <script>
      var heatscale = d3.scaleLinear()
          .domain([0, 0.0001, 1, 2])
	  .range(['#ffffff', '#ffffe0', '#ffff00', '#ff0000']);

      var table = d3.select('div.proteintable').append('table');
      var thead = table.append('thead');
      var tbody = table.append('tbody');

      d3.tsv('data/NrdGRE.domclass.wide.tsv', function(error, ptablew) {
	// Add a hard-coded header row
	thead.append('tr')
	  .selectAll('th')
	  .data(['Domain', 'N. organisms', 'NrdA', 'NrdD', 'NrdJ'])
	  .enter()
	  .append('th')
	    .text(function(c) { return c; });

	// Add rows to table
	var rows = tbody.selectAll('tr')
	  .data(ptablew)
	  .enter()
	  .append('tr')

	// Add cell content to each cell
	var cells = rows.selectAll('td')
	  .data(function(row) {
	    return [ 
	      { value: row.tdomain, background: '#ffffff00' },
	      { value: row.n_orgs, background: '#ffffff00' },
	      { value: row.NrdA, background: d3.rgb(heatscale(row.NrdA/row.n_orgs)) },
	      { value: row.NrdD, background: d3.rgb(heatscale(row.NrdD/row.n_orgs)) },
	      { value: row.NrdJ,  background: d3.rgb(heatscale(row.NrdJ/row.n_orgs)) }
	    ];
	  })
	  .enter()
	  .append('td')
	    .text(function(d) { return d.value; })
	    .style('background', function(d) { return d.background; });
      });
    </script>
  </body>
</html>
